define("modules/h5/home/js/index",["common/share/jssdk","kit/util/asyncModule","modules/h5/testing/js/mark"],function(require,exports,module){function showCharts(data){for(var result=[],i=0,count=data.length;i<count;i++){var item=data[i];result.push({x:item.x.substr(4),y:item.y})}mark.draw(data)}function init(opts){var platform=opts.platform;if(lazyload.load("common/tabbar/js/index.js?v=aaf51221ce",function(ret){ret.setActiveTab(0),tabbar=ret}),jssdk.init(platform,opts.jssdk,function(){if(arguments.length>0)return}),opts.my_score.finished>0)showCharts(opts.my_score.chat)}function destroy(opts){if(tabbar)tabbar.destroy()}var tabbar,jssdk=require("common/share/jssdk"),lazyload=require("kit/util/asyncModule"),mark=require("modules/h5/testing/js/mark"),that={init:init,destroy:destroy};return that}),
define("common/share/jssdk",[],function(require,exports,module){function init(platform,jssdkInfo,callback){if(currentPlatform=platform,true===isInit)return void(callback&&callback());if("weixin"===platform)seajs.use("http://res.wx.qq.com/open/js/jweixin-1.0.0.js",function(weixinSDK){wx=weixinSDK;var info={debug:false,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareWeibo","onMenuShareQZone","startRecord","stopRecord","onVoiceRecordEnd","playVoice","pauseVoice","stopVoice","onVoicePlayEnd","uploadVoice","downloadVoice","chooseImage","previewImage","uploadImage","downloadImage","translateVoice","getNetworkType","openLocation","getLocation","hideOptionMenu","showOptionMenu","hideMenuItems","showMenuItems","hideAllNonBaseMenuItem","showAllNonBaseMenuItem","closeWindow","scanQRCode","chooseWXPay","openProductSpecificView","addCard","chooseCard","openCard"]};for(var key in jssdkInfo)if("url"!=key)info[key]=jssdkInfo[key];wx.ready(function(){isInit=true,callback&&callback()}),wx.error(function(res){callback&&callback(res)}),wx.config(info)});else if("weibo"===platform)seajs.use("http://js.t.sinajs.cn/open/thirdpart/static/jsbridge-sdk/public/weibo_mobile_sdk_min.js?version=20160615",function(ret){var data=jssdkInfo,info={appkey:data.appid,debug:false,timestamp:data.timestamp,noncestr:data.noncestr,signature:data.signature,scope:["pickImage","setSharingContent","openMenu","setMenuItems","menuItemSelected","invokeMenuItem","getNetworkType","networkTypeChanged","getBrowserInfo","checkAvailability","setBrowserTitle","openImage","scanQRCode","getLocation","pickContact"]};ret.ready(function(api){api.checkAvailability({api_list:info.scope,success:function(ret){WeiboJS=api,isInit=true,callback&&callback()},fail:function(msg,code){}})}),ret.error(function(message){}),ret.config(info)})}function getJssdkObject(){if("weibo"===currentPlatform)return WeiboJS;if("weixin"===currentPlatform)return wx}function setWeiboMenu(){}function setWeixinMenu(){}function destroy(){}var isInit=false,wx=null,WeiboJS=null,currentPlatform=null;exports.init=init,exports.getJssdkObject=getJssdkObject,exports.setWeiboMenu=setWeiboMenu,exports.setWeixinMenu=setWeixinMenu,exports.destroy=destroy}),
define("kit/util/asyncModule",[],function(require,exports,module){function Module(opts){if(this.id=getSubModuleUniqueId(),"string"==typeof opts)this.options={js:opts};else this.options=opts;this.loadResources()}function getSubModuleUniqueId(){return"sub_module_"+(new Date).getTime()}function load(opts,callback){var info;if("string"==typeof opts)info={js:opts,success:callback};else info=opts;new Module(info)}function destroy(opts){console.log("destroy about")}var modules={},templates={};Module.prototype.loadResources=function(){var that=this;if(null!=this.options.css&&null==this.css)return void SCRM.load(this.options.css,"css",function(ret){that.css=true,that.loadResources()},{cachecss:this.options.cachecss||false});if(null!=this.options.template&&null==this.template){if(null==templates[this.options.js])SCRM.load(this.options.template,"template",function(ret){if(that.template=true,that.templateText=ret,templates[that.options.template]=ret,null==that.options.js)that.options.success(ret);else that.loadResources()});else that.options.success(templates[this.options.template]);return}if(null!=this.options.js&&null==this.js){if(null==modules[this.options.js])SCRM.load(this.options.js,"js",function(ret){that.js=true,modules[that.options.js]=ret,ret.init(that.templateText,that.options.success)});else modules[this.options.js].init(that.templateText,that.options.success);return}};var that={load:load,destroy:destroy};return that}),
define("modules/h5/testing/js/mark",[],function(require){var $markform,$outer,$canvas,w,h,stepX,stepY,rdata,maxY=0,markerTipNode=document.createElement("span");markerTipNode.className="markerTip";var fixNumber=function(n){var level=parseInt((n.toString().length-1)/3);return(n/Math.pow(10,3*level)).toString().replace(/\.(\d).*$/,".$1")+["","K","M","B"][level]},initXY=function(){stepX=w/rdata.x.length;for(var i=0,len=rdata.x.length;i<len;i++){var span=document.createElement("span");span.className="markXPicker",span.innerHTML=rdata.x[i],span.style.left=i*stepX+"px",$outer.append(span),maxY=Math.max(rdata.y[i],maxY)}var f=maxY.toString().split("").length-1;maxY=parseInt(maxY/Math.pow(10,f)+1)*Math.pow(10,f),stepY=(h-20)/4;for(var i=0;i<4;i++){var span=document.createElement("span");span.className="markYPicker",span.innerHTML=maxY/4*(i+1),span.style.bottom=(i+1)*stepY-13+"px",$outer.append(span)}},drawLine=function(){var ratioY=maxY/100,ctx=$canvas[0].getContext("2d");ctx.beginPath(),ctx.strokeStyle="#f9784b",ctx.lineWidth=1;for(var i=0,len=rdata.x.length;i<len;i++){if(0==i)ctx.moveTo(0,h-rdata.y[0]);!function(k){var x=stepX*k,y=h-rdata.y[k]/ratioY;setTimeout(function(){ctx.lineTo(x,y),ctx.stroke()},60*k),setTimeout(function(){var span=document.createElement("span");if(span.className="marker",span.setAttribute("markerTip",rdata.y[k]),span.style.cssText="left:"+(x-5)+"px;top:"+(y-5)+"px;",$outer.append(span),k==rdata.x.length-1)markerTip.call(span)},500+60*k)}(i)}},markerTip=function(e){markerTipNode.innerHTML=fixNumber($(this).attr("markerTip")),$(this).append(markerTipNode)},init=function(data){rdata=data,$markform=$("#markform"),$outer=$markform.find("[node=outer]"),$canvas=$markform.find("[node=canvas]"),w=$outer.width(),h=$outer.height(),$canvas.attr("width",$outer.width()).attr("height",120),initXY(),drawLine(),$outer.on("click","[markerTip]",markerTip)};return{draw:init}});